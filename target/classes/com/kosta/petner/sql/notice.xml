<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
                        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
                        
<mapper namespace="mapper.notice">
	<insert id="insertNotice" parameterType="com.kosta.petner.bean.Notice">
		<![CDATA[
			insert into notice (notice_no,user_id,notice_title,notice_content,file_no,filepath, notice_re_ref, notice_re_lev, notice_re_seq, notice_hit, reg_date)
			values(notice_seq.nextval,#{user_id},#{notice_title},#{notice_content},#{file_no, jdbcType=VARCHAR},#{filepath, jdbcType=VARCHAR},
				#{notice_re_ref},#{notice_re_lev},#{notice_re_seq},#{notice_hit},sysdate)
		]]>
	</insert>
	
	<select id="selectMaxNoticeNum" resultType="Integer">
		<![CDATA[
			select max(notice_no) from notice
		]]>
	</select>
	
	<select id="selectNoticeList" resultType="com.kosta.petner.bean.Notice" parameterType="Integer">
		<![CDATA[
			select notice_no,user_id,notice_title,notice_content,file_no,notice_re_ref,
				notice_re_lev,notice_re_seq,notice_hit,reg_date 
			from (select row_number() over (order by notice_re_ref desc, notice_re_seq asc) num, N.*
					from notice N order by notice_re_ref desc, notice_re_seq asc)
			where num between #{row} and #{row}+9
		]]>
	</select>
	
	<select id="selectNoticeCount" resultType="Integer">
		<![CDATA[
			select count(*) from notice
		]]>
	</select>
	
	<select id="selectNotice" resultType="com.kosta.petner.bean.Notice" parameterType="Integer">
		<![CDATA[
			select * from notice where notice_no=#{notice_no} ORDER BY notice_no DESC
		]]>
	</select>
	
	<update id="updateNotice" parameterType="com.kosta.petner.bean.Notice">
		<![CDATA[
			update notice set notice_title=#{notice_title}, notice_content=#{notice_content}
			where notice_no=#{notice_no}
		]]>
	</update>
	
	<update id="read">
		<![CDATA[
			UPDATE notice SET notice_hit = notice_hit + 1 WHERE notice_no=#{notice_no}
		]]>
	</update>
	
	<update id="updateNoticeReReq" parameterType="com.kosta.petner.bean.Notice">
		<![CDATA[
			update notice set notice_re_seq=notice_re_seq+1
			where notice_re_ref=#{notice_re_ref} and notice_re_seq>#{notice_re_seq}
		]]>
	</update>
	
	<delete id="deleteNotice" parameterType="Integer">
		<![CDATA[
			delete from notice where notice_no=#{noticeNum}
		]]>
	</delete>
	
	<update id="updateFileNoToNotice" parameterType="com.kosta.petner.bean.Notice">
	<![CDATA[
		update notice
		set file_no = #{file_no}
		where notice_no = #{notice_no}
	]]>	
	</update>
</mapper>














                      